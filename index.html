<!DOCTYPE html>
<html>
<head>
    <title>Coin Collector</title>
    <style>
        body { margin: 0; overflow: hidden; }
        #game { background: #1a1a1a; }
    </style>
</head>
<body>
    <canvas id="game" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        let playerX = 50, playerY = 500, coins = 0, level = 1;
        let keyState = { left: false, right: false };
        let obstacles = [];
        let enemies = [];

        // Level configurations
        const levels = {
            1: {
                coins: [{x:200,y:500}, {x:400,y:500}, {x:600,y:500}],
                obstacles: [{x:300,y:530,w:100,h:20}],
                enemies: []
            },
            2: {
                coins: [{x:150,y:400}, {x:350,y:400}, {x:550,y:400}],
                obstacles: [{x:250,y:430,w:100,h:20}, {x:450,y:430,w:100,h:20}],
                enemies: [{x:500,y:500,speed:2}]
            },
            3: {
                coins: [{x:100,y:300}, {x:300,y:300}, {x:500,y:300}, {x:700,y:300}],
                obstacles: [{x:200,y:330,w:100,h:20}, {x:400,y:330,w:100,h:20}, {x:600,y:330,w:100,h:20}],
                enemies: [{x:200,y:500,speed:3}, {x:600,y:500,speed:-3}]
            },
            4: {
                coins: [{x:50,y:200}, {x:250,y:200}, {x:450,y:200}, {x:650,y:200}, {x:750,y:200}],
                obstacles: [{x:150,y:230,w:100,h:20}, {x:350,y:230,w:100,h:20}, {x:550,y:230,w:100,h:20}],
                enemies: [{x:100,y:500,speed:4}, {x:700,y:500,speed:-4}],
                movingPlatforms: [{x:300,y:400,w:200,h:20,speed:2}]
            }
        };

        function initLevel() {
            const currentLevel = levels[level];
            coins = currentLevel.coins.slice();
            obstacles = currentLevel.obstacles.slice();
            enemies = currentLevel.enemies.map(e => ({...e, dir:1}));
        }

        function draw() {
            // Clear screen
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 800, 600);
            
            // Draw platforms
            ctx.fillStyle = '#666';
            ctx.fillRect(0, 550, 800, 50);
            
            // Draw obstacles
            ctx.fillStyle = '#ff4444';
            obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));
            
            // Draw coins
            ctx.fillStyle = '#ffd700';
            coins.forEach(c => {
                ctx.beginPath();
                ctx.arc(c.x, c.y, 10, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Draw player
            ctx.fillStyle = '#00ff00';
            ctx.fillRect(playerX, playerY, 30, 30);
            
            // Draw UI
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.fillText(`Level: ${level} | Coins: ${coins.length}`, 10, 30);
        }

        // Smooth movement controls
        document.addEventListener('keydown', (e) => {
            if(e.key === 'ArrowLeft') keyState.left = true;
            if(e.key === 'ArrowRight') keyState.right = true;
            if(e.key === 'ArrowUp' && playerY >= 500) playerY -= 100;
        });

        document.addEventListener('keyup', (e) => {
            if(e.key === 'ArrowLeft') keyState.left = false;
            if(e.key === 'ArrowRight') keyState.right = false;
        });

        function update() {
            // Continuous movement
            if(keyState.left) playerX = Math.max(0, playerX - 5);
            if(keyState.right) playerX = Math.min(770, playerX + 5);
            
            // Coin collection
            coins = coins.filter(c => {
                const collected = Math.abs(playerX - c.x) < 30 && 
                                Math.abs(playerY - c.y) < 30;
                return !collected;
            });
            
            // Level complete check
            if(coins.length === 0) {
                level++;
                if(!levels[level]) {
                    alert('CONGRATULATIONS! YOU BEAT ALL LEVELS!');
                    return;
                }
                playerX = 50;
                initLevel();
            }
            
            // Obstacle collision
            obstacles.forEach(o => {
                if(playerX < o.x + o.w &&
                   playerX + 30 > o.x &&
                   playerY < o.y + o.h &&
                   playerY + 30 > o.y) {
                    playerX = 50; // Reset position
                }
            });
            
            // Gravity
            if(playerY < 500) playerY += 3;
        }

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start game
        initLevel();
        gameLoop();
    </script>
</body>
</html>
